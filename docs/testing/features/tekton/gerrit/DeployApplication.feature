Feature: Deploy applications added using Create and Clone strategy Gerrit  Scenario Outline: Deploy application added using Create strategy with default versioning type    Given User opens KubeRocketCI as default user    When User deletes <applicationName> Sonar project if present    When User opens Components tab    And User creates codebase using default versioning type on gerrit      | applicationName   | <applicationName>   |      | codeLanguage      | <codeLanguage>      |      | defaultBranchName | <defaultBranchName> |    Then User sees success status and correct values in fields for <applicationName> application      | codeLanguage | <codeLanguage> |    When User select created application <applicationName> name    Then User sees created <defaultBranchName> branch as default    When User creates new branch with default versioning type in <applicationName> application      | newBranchName | <newBranchName> |    And User triggers build pipeline for <newBranchName> branch name    Then User checks build pipeline status submitted manually for "<newBranchName>" branch in "<applicationName>" codebase    And User checks build pipeline status in KubeRocketCI for <newBranchName> branch in <applicationName> codebase    When User saves the image version in memory as IMAGE_VERSION for <applicationName> application    And User opens Deployment Flows tab    And User creates cd pipeline <pipelineName>      | applicationName | <applicationName> |      | branchName      | <newBranchName>   |      | clusterName     | in-cluster        |      | stageName       | <stageName>       |    And User waits till <pipelineName> pipeline with <stageName> stage will be created    And User opens Deployment Flows tab    Then User sees success status for <pipelineName> deployment flow    When User opens <pipelineName> deployment flow    And User opens <stageName> stage    Then User sees success status for <stageName> stage    When User deploys <applicationName> application with saved image version    Then User checks deploy pipeline status for <stageName> stage in <pipelineName> pipeline with deploy trigger template    And User waits till <applicationName> application for <stageName> stage in <pipelineName> pipeline will be deployed with success status    And User checks logs and terminal popups in default namespace for <applicationName> application <pipelineName> pipeline <stageName> stage    And User uninstalls <applicationName> application    And User deletes <pipelineName> cd pipeline    And User deletes application with name <applicationName>    And User checks default namespace for <stageName> stage in <pipelineName> pipeline is deleted    @UI @TektonGerritUI @TektonGerritDeployUI    Examples:      | applicationName        | defaultBranchName | codeLanguage            | newBranchName | pipelineName | stageName |      | js-exp-app-def-dep-ui  | master            | express_application     | new           | js-exp-dp    | sit       |      | c-none-make-app-dep-ui | master            | c_none_make_application | new           | c-none-dep   | sit       |  Scenario Outline: Deploy application added using Clone strategy with semver versioning type release branch    Given User opens KubeRocketCI as default user    When User deletes <applicationName> Sonar project if present    When User opens Components tab    And User clones codebase using semver versioning type on gerrit      | applicationName   | <applicationName>   |      | codeLanguage      | <codeLanguage>      |      | defaultBranchName | <defaultBranchName> |      | startFromVersion  | 1.2.3               |      | startFromSnapshot | SNAPSHOT            |    Then User sees success status and correct values in fields for <applicationName> application      | codeLanguage | <codeLanguage> |    When User select created application <applicationName> name    Then User sees created <defaultBranchName> branch as default    When User creates new branch with semver versioning type in <applicationName> application      | newBranchName     | <newBranchName> |      | startFromVersion  | 2.3.4           |      | startFromSnapshot | RC              |      | realiseBranch     | True            |    Then User sees created <newBranchName> branch as release    When User triggers build pipeline for <newBranchName> branch name    Then User checks build pipeline status submitted manually for "<newBranchNameFormatted>" branch in "<applicationName>" codebase    And User checks build pipeline status in KubeRocketCI for <newBranchName> branch in <applicationName> codebase    When User saves the image version in memory as IMAGE_VERSION for <applicationName> application    And User opens Deployment Flows tab    And User creates cd pipeline <pipelineName>      | applicationName | <applicationName> |      | branchName      | <newBranchName>   |      | clusterName     | in-cluster        |      | stageName       | <stageName>       |    And User waits till <pipelineName> pipeline with <stageName> stage will be created    And User opens Deployment Flows tab    Then User sees success status for <pipelineName> deployment flow    When User opens <pipelineName> deployment flow    And User opens <stageName> stage    Then User sees success status for <stageName> stage    When User deploys <applicationName> application with saved image version    Then User checks deploy pipeline status for <stageName> stage in <pipelineName> pipeline with deploy trigger template    And User waits till <applicationName> application for <stageName> stage in <pipelineName> pipeline will be deployed with success status    And User uninstalls <applicationName> application    And User deletes <pipelineName> cd pipeline    And User deletes application with name <applicationName>    And User checks default namespace for <stageName> stage in <pipelineName> pipeline is deleted    @UI @TektonGerritUI @TektonGerritDeployUI    Examples:      | applicationName         | defaultBranchName | codeLanguage             | newBranchName | pipelineName | stageName | newBranchNameFormatted |      | c-none-cmake-app-dep-ui | master            | c_none_cmake_application | release/2.3   | c-cnone-dep  | sit       | release-2.3            |      | beego-app-semver-dep-ui | master            | beego_application        | release/2.3   | beego-dp     | dev       | release-2.3            |  Scenario Outline: Check deploy <codeLanguage> application in custom namespace with semver versioning type using create strategy    Given User opens KubeRocketCI as default user    When User deletes <applicationName> Sonar project if present    When User opens Components tab    And User creates codebase using semver versioning type on gerrit      | applicationName   | <applicationName>   |      | codeLanguage      | <codeLanguage>      |      | defaultBranchName | <defaultBranchName> |      | startFromVersion  | 7.9.5               |      | startFromSnapshot | NEW-SNAPSHOT        |    Then User sees success status and correct values in fields for <applicationName> application      | codeLanguage | <codeLanguage> |    When User select created application <applicationName> name    Then User sees created <defaultBranchName> branch as default    And User triggers build pipeline for <defaultBranchName> branch name    Then User checks build pipeline status submitted manually for "<defaultBranchName>" branch in "<applicationName>" codebase    And User checks build pipeline status in KubeRocketCI for <defaultBranchName> branch in <applicationName> codebase    When User saves the image version in memory as IMAGE_VERSION for <applicationName> application    And User opens Deployment Flows tab    And User creates cd pipeline <pipelineName>      | applicationName     | <applicationName>     |      | branchName          | <defaultBranchName>   |      | clusterName         | in-cluster            |      | stageName           | <stageName>           |      | customNamespaceName | <customNamespaceName> |    And User waits till <pipelineName> pipeline with <stageName> stage will be created    And User opens Deployment Flows tab    Then User sees success status for <pipelineName> deployment flow    When User opens <pipelineName> deployment flow    And User opens <stageName> stage    Then User sees success status for <stageName> stage    When User deploys <applicationName> application with saved image version    Then User checks deploy pipeline status for <stageName> stage in <pipelineName> pipeline with deploy trigger template    And User waits till <applicationName> application for <stageName> stage in <pipelineName> pipeline will be deployed with success status    And User checks deployed <applicationName> application in <customNamespaceName> namespace    And User uninstalls <applicationName> application    And User deletes <pipelineName> cd pipeline    And User deletes application with name <applicationName>    And User checks namespace with <customNamespaceName> namespace is deleted    @UI @TektonGerritUI @TektonGerritDeployUI    Examples:      | applicationName     | defaultBranchName | codeLanguage              | pipelineName   | stageName | customNamespaceName       |      | python38-dep-cn-ui  | master            | python_3_8_application    | python38-dp-cn | dev       | python38-custom-namespace |      | cpp-make-app-dep-ui | master            | cpp_none_make_application | cpp-dep        | dev       | cpp-custom-namespace      |  Scenario Outline: Check deploy <codeLanguage> application using custom values file with semver versioning type using create strategy    Given Used adds custom values file to the GitOps repository with parameters gerrit project      | applicationName | <applicationName> |      | pipelineName    | <pipelineName>    |      | stageName       | <stageName>       |      | content         | replicaCount: 2   |    Given User opens KubeRocketCI as default user    When User deletes <applicationName> Sonar project if present    And User opens Components tab    And User creates codebase using semver versioning type on gerrit      | applicationName   | <applicationName>   |      | codeLanguage      | <codeLanguage>      |      | defaultBranchName | <defaultBranchName> |      | startFromVersion  | 7.9.5               |      | startFromSnapshot | NEW-SNAPSHOT        |    Then User sees success status and correct values in fields for <applicationName> application      | codeLanguage | <codeLanguage> |    When User select created application <applicationName> name    Then User sees created <defaultBranchName> branch as default    And User triggers build pipeline for <defaultBranchName> branch name    Then User checks build pipeline status submitted manually for "<defaultBranchName>" branch in "<applicationName>" codebase    And User checks build pipeline status in KubeRocketCI for <defaultBranchName> branch in <applicationName> codebase    When User saves the image version in memory as IMAGE_VERSION for <applicationName> application    And User opens Deployment Flows tab    And User creates cd pipeline <pipelineName>      | applicationName | <applicationName>   |      | branchName      | <defaultBranchName> |      | clusterName     | in-cluster          |      | stageName       | <stageName>         |    And User waits till <pipelineName> pipeline with <stageName> stage will be created    And User opens Deployment Flows tab    Then User sees success status for <pipelineName> deployment flow    When User opens <pipelineName> deployment flow    And User opens <stageName> stage    Then User sees success status for <stageName> stage    When User deploys <applicationName> application with saved image version and custom values file    Then User checks deploy pipeline status for <stageName> stage in <pipelineName> pipeline with deploy trigger template    And User waits till <applicationName> application for <stageName> stage in <pipelineName> pipeline will be deployed with success status    And User checks deployed <applicationName> application in the default namespace for <stageName> stage in <pipelineName> pipeline with 2 replicas    And User uninstalls <applicationName> application    And User deletes <pipelineName> cd pipeline    And User deletes application with name <applicationName>    And User checks default namespace for <stageName> stage in <pipelineName> pipeline is deleted    @UI @TektonGerritUI @TektonGerritDeployUI    Examples:      | applicationName    | defaultBranchName | codeLanguage              | pipelineName    | stageName |      | java11-g-gitops-ui | master            | java11_gradle_application | java11-g-gitops | dev       |  Scenario Outline: Check deploy <codeLanguage> application using custom values file with ingress default version create strategy    Given Used adds custom values file to the GitOps repository with parameters gerrit project      | applicationName | <applicationName>         |      | pipelineName    | <pipelineName>            |      | stageName       | <stageName>               |      | content         | ingress:\n  enabled: true |    Given User opens KubeRocketCI as default user    When User deletes <applicationName> Sonar project if present    And User opens Components tab    And User creates codebase using semver versioning type on gerrit      | applicationName   | <applicationName>   |      | codeLanguage      | <codeLanguage>      |      | defaultBranchName | <defaultBranchName> |      | startFromVersion  | 7.9.5               |      | startFromSnapshot | NEW-SNAPSHOT        |    Then User sees success status and correct values in fields for <applicationName> application      | codeLanguage | <codeLanguage> |    When User select created application <applicationName> name    Then User sees created <defaultBranchName> branch as default    And User triggers build pipeline for <defaultBranchName> branch name    Then User checks build pipeline status submitted manually for "<defaultBranchName>" branch in "<applicationName>" codebase    And User checks build pipeline status in KubeRocketCI for <defaultBranchName> branch in <applicationName> codebase    When User saves the image version in memory as IMAGE_VERSION for <applicationName> application    And User opens Deployment Flows tab    And User creates cd pipeline <pipelineName>      | applicationName | <applicationName>   |      | branchName      | <defaultBranchName> |      | clusterName     | in-cluster          |      | stageName       | <stageName>         |    And User waits till <pipelineName> pipeline with <stageName> stage will be created    And User opens Deployment Flows tab    Then User sees success status for <pipelineName> deployment flow    When User opens <pipelineName> deployment flow    And User opens <stageName> stage    Then User sees success status for <stageName> stage    When User deploys <applicationName> application with saved image version and custom values file    Then User checks deploy pipeline status for <stageName> stage in <pipelineName> pipeline with deploy trigger template    And User waits till <applicationName> application for <stageName> stage in <pipelineName> pipeline will be deployed with success status    And User checks ingress link in default namespace for <applicationName> application for <stageName> stage <pipelineName> pipeline    And User checks deployed <applicationName> application in the default namespace for <stageName> stage in <pipelineName> pipeline    And User checks create ingress in default namespace for <applicationName> application for <stageName> stage <pipelineName> pipeline    And User uninstalls <applicationName> application    And User deletes <pipelineName> cd pipeline    And User deletes application with name <applicationName>    And User checks default namespace for <stageName> stage in <pipelineName> pipeline is deleted    @UI @TektonGerritUI @TektonGerritDeployUI    Examples:      | applicationName      | defaultBranchName | codeLanguage              | pipelineName      | stageName |      | java11-ingress-ui-gr | master            | java11_gradle_application | java11-ingress-gr | dev       |  Scenario Outline: Check clean pipeline run for <codeLanguage> application using default version create strategy    Given User opens KubeRocketCI as default user    When User deletes <applicationName> Sonar project if present    When User opens Components tab    And User creates codebase using default versioning type on gerrit      | applicationName   | <applicationName>   |      | codeLanguage      | <codeLanguage>      |      | defaultBranchName | <defaultBranchName> |    Then User sees success status and correct values in fields for <applicationName> application      | codeLanguage | <codeLanguage> |    When User select created application <applicationName> name    Then User sees created <defaultBranchName> branch as default    And User triggers build pipeline for <defaultBranchName> branch name    Then User checks build pipeline status submitted manually for "<defaultBranchName>" branch in "<applicationName>" codebase    And User checks build pipeline status in KubeRocketCI for <defaultBranchName> branch in <applicationName> codebase    When User saves the image version in memory as IMAGE_VERSION for <applicationName> application    And User opens Deployment Flows tab    And User creates cd pipeline <pipelineName>      | applicationName | <applicationName>   |      | branchName      | <defaultBranchName> |      | clusterName     | in-cluster          |      | stageName       | <stageName>         |    And User waits till <pipelineName> pipeline with <stageName> stage will be created    And User opens Deployment Flows tab    Then User sees success status for <pipelineName> deployment flow    When User opens <pipelineName> deployment flow    And User opens <stageName> stage    Then User sees success status for <stageName> stage    When User deploys <applicationName> application with saved image version    Then User checks deploy pipeline status for <stageName> stage in <pipelineName> pipeline with deploy trigger template    And User waits till <applicationName> application for <stageName> stage in <pipelineName> pipeline will be deployed with success status    And User opens Deployment Flows tab    When User opens <pipelineName> deployment flow    When I login to ArgoCd from <stageName> pipeline    When User checks <stageName> pipeline has healthy status on ArgoCd    When User switches to 1 browser tab    When User triggers Clean pipeline for <stageName> environment    When User opens Pipelines tab    Then User select and checks pipeline with clean type success status for <pipelineName>-<stageName> codebase    When User switches to 2 browser tab    When User checks <stageName> pipeline has missing status on ArgoCd    @UI @TektonGerritUI @TektonGerritDeployUI    Examples:      | applicationName     | defaultBranchName | codeLanguage              | pipelineName | stageName |      | java11-ger-clean-ui | master            | java11_gradle_application | java11-clean | dev       |  Scenario Outline: Check create/edit/delete variables on Variables tab    Given User opens KubeRocketCI as default user    When User deletes <applicationName> Sonar project if present    When User opens Components tab    And User creates codebase using default versioning type on gerrit      | applicationName   | <applicationName>   |      | codeLanguage      | <codeLanguage>      |      | defaultBranchName | <defaultBranchName> |    And User opens Deployment Flows tab    And User creates cd pipeline <pipelineName>      | applicationName | <applicationName>   |      | branchName      | <defaultBranchName> |      | clusterName     | in-cluster          |      | stageName       | <stageName>         |    And User opens <stageName> stage    And User opens Variables tab on Deployment Flows tab    And User adds key1 variable with value1 value on Variables tab    And User adds key2 variable with value2 value on Variables tab    And User saves changes on Variables tab    Then User checks that variables are present on Variable tab and <pipelineName>-<stageName> ConfigMap:      | key  | value  |      | key1 | value1 |      | key2 | value2 |    When User adds key3 variable with value3 value on Variables tab    And User undo changes on Variables tab    Then User checks that variables are present on Variable tab and <pipelineName>-<stageName> ConfigMap:      | key  | value  |      | key1 | value1 |      | key2 | value2 |    When User deletes variable key2 on Variables tab    And User saves changes on Variables tab    Then User checks that variables aren't present on Variable tab and <pipelineName>-<stageName> ConfigMap:      | key  | value  |      | key2 | value2 |    When User deletes variable key1 on Variables tab    Then User checks message is present:    """    Are you sure you want to save empty variable list?    """    When User saves changes on Variables tab    Then User checks message is present:    """    No variables found.    """    @UI @TektonGerritUI @TektonGerritNoDeployUI    Examples:      | applicationName      | defaultBranchName | codeLanguage              | pipelineName  | stageName |      | java11-ger-vartab-ui | master            | java11_gradle_application | java11-vartab | dev       |  Scenario Outline: Check custom deploy/clean pipelines set in pipeline creation    Given User opens KubeRocketCI as default user    When User deletes <applicationName> Sonar project if present    When User opens Components tab    And User creates codebase using default versioning type on gerrit      | applicationName   | <applicationName>   |      | codeLanguage      | <codeLanguage>      |      | defaultBranchName | <defaultBranchName> |    And User creates custom clean trigger template with testclean name    And User creates custom deploy trigger template with testdeploy name    And User opens Deployment Flows tab    And User creates cd pipeline <pipelineName>      | applicationName | <applicationName>   |      | branchName      | <defaultBranchName> |      | clusterName     | in-cluster          |      | stageName       | <stageName>         |      | triggerTemplate | testdeploy          |      | cleanTemplate   | testclean           |    Then User waits till <pipelineName> pipeline with <stageName> stage will be created    And User deletes custom trigger template with testclean name    And User deletes custom trigger template with testdeploy name    @UI @TektonGerritUI @TektonGerritNoDeployUI    Examples:      | applicationName       | defaultBranchName | codeLanguage             | pipelineName   | stageName |      | java8-ger-custpipe-ui | master            | java8_gradle_application | java8-custpipe | dev       |