Feature: Deploy in remote cluster  Scenario Outline: Check deploy in remote cluster without promote using deploy trigger template OKD    Given User creates default codebase on gitlab      | applicationName | <applicationName> |      | codeLanguage    | <codeLanguage>    |    And User triggers build pipeline type for <defaultBranchName> branch in <applicationName> codebase      | codeLanguage   | <codeLanguage> |      | versioningType | default        |    Then User checks build pipeline status for "<defaultBranchName>" branch in "<applicationName>" codebase    When User creates cd pipeline <pipelineName> with deployment type container      | applicationName | <applicationName>   |      | branchName      | <defaultBranchName> |    And User creates stage <stageName> in cd pipeline <pipelineName>      | applicationName | <applicationName> |      | triggerType     | Manual            |      | jobProvisioning | default           |      | source          | default           |      | qualityGateType | manual            |      | stepName        | manual            |      | clusterName     | okd               |    And User deploys application using deploy pipeline      | applicationName | <applicationName> |      | pipelineName    | <pipelineName>    |      | stageName       | <stageName>       |      | clusterName     | okd               |    And User checks deployed <applicationName> application in the default namespace of OKD cluster for <stageName> stage in <pipelineName> pipeline    And User checks that IMAGE_VERSION image isn't promoted for <applicationName> application for <stageName> stage <pipelineName> pipeline    And User deletes <pipelineName> application set    And User deletes <pipelineName>-<stageName> cd pipeline stage resources    And User deletes <pipelineName> cd pipeline resources    And User deletes "<applicationName>" codebase resources    And User checks default namespace for <stageName> stage in <pipelineName> pipeline is deleted on OKD cluster    @TektonGitlabRemoteOKDClusterDeploy    Examples:      | applicationName   | codeLanguage             | defaultBranchName | pipelineName   | stageName |      | java11-mvn-remote | java11_maven_application | master            | java11-mvn-rem | sit       |  Scenario Outline: Check deploy in the custom namespace of remote cluster using deploy-with-autotests trigger template OKD    Given User clones semver codebase on gitlab      | applicationName | <autotestName>         |      | codeLanguage    | <autotestCodeLanguage> |      | startFrom       | 1.2.3-SNAPSHOT         |    And User creates semver codebase on gitlab      | applicationName | <applicationName> |      | codeLanguage    | <codeLanguage>    |      | startFrom       | 1.2.3-SNAPSHOT    |    When User creates new release branch      | applicationName  | <applicationName>  |      | branchName       | <newBranchName>    |      | newBranchVersion | <newBranchVersion> |    And User triggers build pipeline type for <newBranchName> branch in <applicationName> codebase      | codeLanguage   | <codeLanguage> |      | versioningType | semver            |    Then User checks build pipeline status for "<newBranchName>" branch in "<applicationName>" codebase    When User creates cd pipeline <pipelineName> with deployment type container      | applicationName   | <applicationName> |      | branchName        | <newBranchName>   |      | promoteInPipeline | True              |    And User creates stage <stageName> in cd pipeline <pipelineName>      | applicationName     | <applicationName>     |      | triggerType         | Manual                |      | jobProvisioning     | default               |      | source              | default               |      | qualityGateType     | autotests             |      | stepName            | auto-test             |      | autotestName        | <autotestName>        |      | branchName          | master                |      | triggerTemplate     | deploy-with-autotests |      | clusterName         | okd                   |      | customNamespaceName | <customNamespaceName> |    And User deploys application using deploy-with-autotests pipeline      | applicationName | <applicationName> |      | pipelineName    | <pipelineName>    |      | stageName       | <stageName>       |      | clusterName     | okd               |    And User checks autotests-gradle autotest pipeline status for "<stageName>" stage in "<pipelineName>" pipeline    And User checks deployed <applicationName> application in <customNamespaceName> namespace on OKD cluster    And User checks IMAGE_VERSION promoted image for <applicationName> application for <stageName> stage <pipelineName> pipeline    And User deletes <pipelineName> application set    And User deletes <pipelineName>-<stageName> cd pipeline stage resources    And User deletes <pipelineName> cd pipeline resources    And User deletes "<applicationName>" codebase resources    And User deletes "<autotestName>" codebase resources    And User checks namespace with <customNamespaceName> namespace is deleted on OKD cluster    @TektonGitlabRemoteOKDClusterDeploy    Examples:      | applicationName | codeLanguage           | newBranchName | newBranchVersion | pipelineName    | stageName | autotestName          | autotestCodeLanguage   | customNamespaceName       |      | python38-remote | python_3_8_application | release-1.2   | 1.2.3-RC         | python38-remote | sit       | java17-grd-aut-remote | java17_gradle_autotest | python38-custom-ns-remote |  Scenario Outline: Check auto deploy with promote using deploy trigger template in remote cluster OKD    Given User creates semver codebase on gitlab      | applicationName | <applicationName> |      | codeLanguage    | <codeLanguage>    |      | startFrom       | <startFrom>       |    When User creates new release branch      | applicationName  | <applicationName>  |      | branchName       | <newBranchName>    |      | newBranchVersion | <newBranchVersion> |    And User creates cd pipeline <pipelineName> with deployment type container      | applicationName   | <applicationName> |      | branchName        | <newBranchName>   |      | promoteInPipeline | True              |    And User creates stage <stageName> in cd pipeline <pipelineName>      | applicationName | <applicationName> |      | triggerType     | Auto              |      | jobProvisioning | default           |      | source          | default           |      | qualityGateType | manual            |      | stepName        | manual            |      | clusterName     | okd               |    And User triggers build pipeline type for <newBranchName> branch in <applicationName> codebase      | codeLanguage   | <codeLanguage> |      | versioningType | semver            |    Then User checks build pipeline status for "<newBranchName>" branch in "<applicationName>" codebase    When User saves the image version in memory as IMAGE_VERSION for <applicationName> application    Then User checks deploy pipeline and application status for <applicationName> application in <stageName> stage <pipelineName> pipeline    And User checks deployed <applicationName> application in the default namespace of OKD cluster for <stageName> stage in <pipelineName> pipeline    And User checks IMAGE_VERSION promoted image for <applicationName> application for <stageName> stage <pipelineName> pipeline    And User deletes <pipelineName> application set    And User deletes <pipelineName>-<stageName> cd pipeline stage resources    And User deletes <pipelineName> cd pipeline resources    And User deletes "<applicationName>" codebase resources    And User checks default namespace for <stageName> stage in <pipelineName> pipeline is deleted on OKD cluster    @TektonGitlabRemoteOKDClusterDeploy    Examples:      | applicationName  | codeLanguage             | newBranchName | startFrom      | newBranchVersion | pipelineName     | stageName |      | oper-sdk-aut-rmt | operator_sdk_application | release-2.3   | 2.3.1-SNAPSHOT | 2.3.1-RC         | oper-sdk-aut-rmt | sit       |  Scenario Outline: Check deploy using custom values file with custom namespace in remote cluster OKD    Given Used adds custom values file to the GitOps repository with parameters gitlab project      | applicationName | <applicationName> |      | pipelineName    | <pipelineName>    |      | stageName       | <stageName>       |      | content         | replicaCount: 2   |    When User creates default codebase on gitlab      | applicationName | <applicationName> |      | codeLanguage    | <codeLanguage>    |    And User triggers build pipeline type for <defaultBranchName> branch in <applicationName> codebase      | codeLanguage   | <codeLanguage> |      | versioningType | default        |    Then User checks build pipeline status for "<defaultBranchName>" branch in "<applicationName>" codebase    When User creates cd pipeline <pipelineName> with deployment type container      | applicationName | <applicationName>   |      | branchName      | <defaultBranchName> |    And User creates stage <stageName> in cd pipeline <pipelineName>      | applicationName     | <applicationName>     |      | triggerType         | Manual                |      | jobProvisioning     | default               |      | source              | default               |      | qualityGateType     | manual                |      | stepName            | manual                |      | customNamespaceName | <customNamespaceName> |      | clusterName         | okd                   |    And User deploys application using deploy pipeline      | applicationName     | <applicationName> |      | pipelineName        | <pipelineName>    |      | stageName           | <stageName>       |      | useCustomValuesFile | true              |      | clusterName         | okd               |    And User checks deployed <applicationName> application in <customNamespaceName> namespace with 2 replicas on OKD cluster    And User checks that IMAGE_VERSION image isn't promoted for <applicationName> application for <stageName> stage <pipelineName> pipeline    And User deletes <pipelineName> application set    And User deletes <pipelineName>-<stageName> cd pipeline stage resources    And User deletes <pipelineName> cd pipeline resources    And User deletes "<applicationName>" codebase resources    And User checks namespace with <customNamespaceName> namespace is deleted on OKD cluster    @TektonGitlabRemoteOKDClusterDeploy    Examples:      | applicationName | codeLanguage               | pipelineName    | stageName | defaultBranchName | customNamespaceName      |      | fastapi-ops-rmt | python_fastapi_application | fastapi-ops-rmt | sit       | master            | fastapi-custom-ns-remote |  Scenario Outline: Check deploy in remote cluster without promote using deploy trigger template vCluster    Given User creates default codebase on gitlab      | applicationName | <applicationName> |      | codeLanguage    | <codeLanguage>    |    And User triggers build pipeline type for <defaultBranchName> branch in <applicationName> codebase      | codeLanguage   | <codeLanguage> |      | versioningType | default        |    Then User checks build pipeline status for "<defaultBranchName>" branch in "<applicationName>" codebase    When User creates cd pipeline <pipelineName> with deployment type container      | applicationName | <applicationName>   |      | branchName      | <defaultBranchName> |    And User creates stage <stageName> in cd pipeline <pipelineName>      | applicationName | <applicationName> |      | triggerType     | Manual            |      | jobProvisioning | default           |      | source          | default           |      | qualityGateType | manual            |      | stepName        | manual            |      | clusterName     | vcluster          |    And User deploys application using deploy pipeline      | applicationName | <applicationName> |      | pipelineName    | <pipelineName>    |      | stageName       | <stageName>       |      | clusterName     | vcluster          |#    And User checks deployed <applicationName> application in the default namespace of OKD cluster for <stageName> stage in <pipelineName> pipeline    And User checks that IMAGE_VERSION image isn't promoted for <applicationName> application for <stageName> stage <pipelineName> pipeline    And User deletes <pipelineName> application set    And User deletes <pipelineName>-<stageName> cd pipeline stage resources    And User deletes <pipelineName> cd pipeline resources    And User deletes "<applicationName>" codebase resources#    And User checks default namespace for <stageName> stage in <pipelineName> pipeline is deleted on OKD cluster    @TektonGitlabRemoteVClusterDeploy @GitlabRemoteVCluster    Examples:      | applicationName     | codeLanguage             | defaultBranchName | pipelineName   | stageName |      | java11-mvn-vcluster | java11_maven_application | master            | java11-mvn-vcl | sit       |  Scenario Outline: Check deploy in the custom namespace of remote cluster using deploy-with-autotests trigger template vCluster    Given User clones semver codebase on gitlab      | applicationName | <autotestName>         |      | codeLanguage    | <autotestCodeLanguage> |      | startFrom       | 1.2.3-SNAPSHOT         |    And User creates semver codebase on gitlab      | applicationName | <applicationName> |      | codeLanguage    | <codeLanguage>    |      | startFrom       | 1.2.3-SNAPSHOT    |    When User creates new release branch      | applicationName  | <applicationName>  |      | branchName       | <newBranchName>    |      | newBranchVersion | <newBranchVersion> |    And User triggers build pipeline type for <newBranchName> branch in <applicationName> codebase      | codeLanguage   | <codeLanguage> |      | versioningType | semver            |    Then User checks build pipeline status for "<newBranchName>" branch in "<applicationName>" codebase    When User creates cd pipeline <pipelineName> with deployment type container      | applicationName   | <applicationName> |      | branchName        | <newBranchName>   |      | promoteInPipeline | True              |    And User creates stage <stageName> in cd pipeline <pipelineName>      | applicationName     | <applicationName>     |      | triggerType         | Manual                |      | jobProvisioning     | default               |      | source              | default               |      | qualityGateType     | autotests             |      | stepName            | auto-test             |      | autotestName        | <autotestName>        |      | branchName          | master                |      | triggerTemplate     | deploy-with-autotests |      | clusterName         | vcluster              |      | customNamespaceName | <customNamespaceName> |    And User deploys application using deploy-with-autotests pipeline      | applicationName | <applicationName> |      | pipelineName    | <pipelineName>    |      | stageName       | <stageName>       |      | clusterName     | vcluster          |    And User checks autotests-gradle autotest pipeline status for "<stageName>" stage in "<pipelineName>" pipeline#    And User checks deployed <applicationName> application in <customNamespaceName> namespace on OKD cluster    And User checks IMAGE_VERSION promoted image for <applicationName> application for <stageName> stage <pipelineName> pipeline    And User deletes <pipelineName> application set    And User deletes <pipelineName>-<stageName> cd pipeline stage resources    And User deletes <pipelineName> cd pipeline resources    And User deletes "<applicationName>" codebase resources    And User deletes "<autotestName>" codebase resources#    And User checks namespace with <customNamespaceName> namespace is deleted on OKD cluster    @TektonGitlabRemoteVClusterDeploy @GitlabRemoteVCluster    Examples:      | applicationName   | codeLanguage           | newBranchName | newBranchVersion | pipelineName | stageName | autotestName            | autotestCodeLanguage   | customNamespaceName         |      | python38-vcluster | python_3_8_application | release-1.2   | 1.2.3-RC         | python38-vcl | sit       | java17-grd-aut-vcluster | java17_gradle_autotest | python38-custom-ns-vcluster |  Scenario Outline: Check auto deploy with promote using deploy trigger template in remote cluster vCluster    Given User creates semver codebase on gitlab      | applicationName | <applicationName> |      | codeLanguage    | <codeLanguage>    |      | startFrom       | <startFrom>       |    When User creates new release branch      | applicationName  | <applicationName>  |      | branchName       | <newBranchName>    |      | newBranchVersion | <newBranchVersion> |    And User creates cd pipeline <pipelineName> with deployment type container      | applicationName   | <applicationName> |      | branchName        | <newBranchName>   |      | promoteInPipeline | True              |    And User creates stage <stageName> in cd pipeline <pipelineName>      | applicationName | <applicationName> |      | triggerType     | Auto              |      | jobProvisioning | default           |      | source          | default           |      | qualityGateType | manual            |      | stepName        | manual            |      | clusterName     | vcluster          |    And User triggers build pipeline type for <newBranchName> branch in <applicationName> codebase      | codeLanguage   | <codeLanguage> |      | versioningType | semver            |    Then User checks build pipeline status for "<newBranchName>" branch in "<applicationName>" codebase    When User saves the image version in memory as IMAGE_VERSION for <applicationName> application    Then User checks deploy pipeline and application status for <applicationName> application in <stageName> stage <pipelineName> pipeline#    And User checks deployed <applicationName> application in the default namespace of OKD cluster for <stageName> stage in <pipelineName> pipeline    And User checks IMAGE_VERSION promoted image for <applicationName> application for <stageName> stage <pipelineName> pipeline    And User deletes <pipelineName> application set    And User deletes <pipelineName>-<stageName> cd pipeline stage resources    And User deletes <pipelineName> cd pipeline resources    And User deletes "<applicationName>" codebase resources#    And User checks default namespace for <stageName> stage in <pipelineName> pipeline is deleted on OKD cluster    @TektonGitlabRemoteVClusterDeploy @GitlabRemoteVCluster    Examples:      | applicationName  | codeLanguage             | newBranchName | startFrom      | newBranchVersion | pipelineName     | stageName |      | oper-sdk-aut-vcl | operator_sdk_application | release-2.3   | 2.3.1-SNAPSHOT | 2.3.1-RC         | oper-sdk-aut-vcl | sit       |  Scenario Outline: Check deploy using custom values file with custom namespace in remote cluster vCluster    Given Used adds custom values file to the GitOps repository with parameters gitlab project      | applicationName | <applicationName> |      | pipelineName    | <pipelineName>    |      | stageName       | <stageName>       |      | content         | replicaCount: 2   |    When User creates default codebase on gitlab      | applicationName | <applicationName> |      | codeLanguage    | <codeLanguage>    |    And User triggers build pipeline type for <defaultBranchName> branch in <applicationName> codebase      | codeLanguage   | <codeLanguage> |      | versioningType | default        |    Then User checks build pipeline status for "<defaultBranchName>" branch in "<applicationName>" codebase    When User creates cd pipeline <pipelineName> with deployment type container      | applicationName | <applicationName>   |      | branchName      | <defaultBranchName> |    And User creates stage <stageName> in cd pipeline <pipelineName>      | applicationName     | <applicationName>     |      | triggerType         | Manual                |      | jobProvisioning     | default               |      | source              | default               |      | qualityGateType     | manual                |      | stepName            | manual                |      | customNamespaceName | <customNamespaceName> |      | clusterName         | vcluster              |    And User deploys application using deploy pipeline      | applicationName     | <applicationName> |      | pipelineName        | <pipelineName>    |      | stageName           | <stageName>       |      | useCustomValuesFile | true              |      | clusterName         | vcluster          |#    And User checks deployed <applicationName> application in <customNamespaceName> namespace with 2 replicas on OKD cluster    And User checks that IMAGE_VERSION image isn't promoted for <applicationName> application for <stageName> stage <pipelineName> pipeline    And User deletes <pipelineName> application set    And User deletes <pipelineName>-<stageName> cd pipeline stage resources    And User deletes <pipelineName> cd pipeline resources    And User deletes "<applicationName>" codebase resources#    And User checks namespace with <customNamespaceName> namespace is deleted on OKD cluster    @TektonGitlabRemoteVClusterDeploy @GitlabRemoteVCluster    Examples:      | applicationName | codeLanguage               | pipelineName    | stageName | defaultBranchName | customNamespaceName        |      | fastapi-ops-vcl | python_fastapi_application | fastapi-ops-vcl | sit       | master            | fastapi-custom-ns-vcluster |